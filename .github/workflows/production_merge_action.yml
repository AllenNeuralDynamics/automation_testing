name: production-merge-action
run-name: Production Merge 
on: workflow_dispatch
#on:
#    schedule:
#    - cron: '48 * * * *'
jobs:
    create-production-merge:
        runs-on: ubuntu-latest
        steps:
            - name: checkout repository
              uses: actions/checkout@v4
              with:
                fetch-depth: 0
            - name: get current date
              id: date
              run: |
                echo "date=$(date +'%Y-%m-%d')" >> "$GITHUB_ENV"
            - run: echo $date
            - run: echo "testing string ${{ env.date }}"
            - name: create pull request
              run: p=$(gh pr create -B production_testing -H develop --title "[Production Merge] ${{ env.date }}" --body 'Created by Github Actions') >> "$GITHUB_ENV"
              env:
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
            - run: echo $date
            - name: merge pull request
              run: gh pr merge production_testing --admin
              env:
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

